---
title: ใช้นิพจน์กับเงื่อนไข | Microsoft Docs
description: ใช้นิพจน์ขั้นสูงเช่น "และ" "หรือ", "ว่าง" "น้อยกว่า" และ "มากกว่า" ด้วยเงื่อนไข Microsoft Flow
services: ''
suite: flow
documentationcenter: na
author: msftman
manager: anneta
editor: ''
tags: ''
ms.service: flow
ms.devlang: na
ms.topic: article
ms.tgt_pltfrm: na
ms.workload: na
ms.date: 08/01/2017
ms.author: deonhe
search.app:
- Flow
search.audienceType:
- flowmaker
- enduser
ms.openlocfilehash: 430d29c4520cbe28801b6912b58a5819a59b5168
ms.sourcegitcommit: a20fbed9941f0cd8b69dc579277a30da9c8bb31b
ms.translationtype: HT
ms.contentlocale: th-TH
ms.lasthandoff: 09/12/2018
ms.locfileid: "44690548"
---
# <a name="use-expressions-in-conditions-to-check-multiple-values"></a>ใช้นิพจน์ในเงื่อนไขเพื่อตรวจสอบค่าหลายค่า
ในการฝึกปฏิบัตินี้ คุณจะได้เรียนรู้วิธีใช้นิพจน์ และ**เงื่อนไข** เพื่อเปรียบเทียบค่าหลายค่าใน**โหมดขั้นสูง**

เมื่อคุณสร้างโฟลว์ คุณสามารถใช้การ์ด[**เงื่อนไข**](add-condition.md#add-a-condition)ในโหมดพื้นฐาน เพื่อเปรียบเทียบค่าเดียวกับอีกค่าหนึ่งได้อย่างรวดเร็วได้ แต่บางครั้งคุณต้องการเปรียบเทียบค่าหลายค่า ตัวอย่างเช่น คุณอาจต้องการตรวจสอบค่าของบางคอลัมน์ในสเปรดชีต หรือบางตารางในฐานข้อมูล

คุณสามารถใช้การรวมของนิพจน์ตรรกะต่อไปนี้ในเงื่อนไขของคุณ

นิพจน์|คำอธิบาย|ตัวอย่าง
--------|-----------|-------
|[และ](#use-the-and-expression)|รับสองอาร์กิวเมนต์ และส่งกลับค่า true ถ้าค่าทั้งสองเป็นจริง<br><b>หมายเหตุ</b>: ทั้งสองอาร์กิวเมนต์ต้องเป็นบูลีน|นิพจน์นี้ส่งกลับเป็น false: <br>and(greater(1,10),equals(0,0))
|[หรือ](#use-the-or-expression)|รับสองอาร์กิวเมนต์ และส่งกลับค่า true ถ้าอาร์กิวเมนต์ตัวใดตัวหนึ่งเป็นจริง <br><b>หมายเหตุ</b>: ทั้งสองอาร์กิวเมนต์ต้องเป็นบูลีน|นิพจน์นี้ส่งกลับ true:<br>or(greater(1,10),equals(0,0))
|equals|ส่งกลับเป็น true ถ้าค่าทั้งสองเท่ากัน|ตัวอย่างเช่น ถ้า parameter1 มีค่าเป็น someValue นิพจน์นี้ส่งกลับ true:<br>equals(parameters('parameter1'), 'someValue')
|[less](#use-the-less-expression)|รับสองอาร์กิวเมนต์ และส่งกลับค่า true ถ้าอาร์กิวเมนต์แรกน้อยกว่าอาร์กิวเมนต์ที่สอง <br><b>หมายเหตุ</b>: ชนิดที่รองรับคือ จำนวนเต็ม เลขทศนิยม และสตริง|นิพจน์นี้ส่งกลับ true:<br>less(10,100)
|lessOrEquals|รับสองอาร์กิวเมนต์ และส่งกลับค่า true ถ้าอาร์กิวเมนต์แรกน้อยกว่าหรือเท่ากับอาร์กิวเมนต์ที่สอง <br><b>หมายเหตุ</b>: ชนิดที่รองรับคือ จำนวนเต็ม เลขทศนิยม และสตริง|นิพจน์นี้ส่งกลับ true:<br>lessOrEquals(10,10)
|[greater](#use-the-greater-expression)|รับสองอาร์กิวเมนต์ และส่งกลับค่า true ถ้าอาร์กิวเมนต์แรกมีค่ามากกว่าอาร์กิวเมนต์ที่สอง <br><b>หมายเหตุ</b>: ชนิดที่รองรับคือ จำนวนเต็ม เลขทศนิยม และสตริง|นิพจน์นี้ส่งกลับเป็น false:<br>greater(10,10)
|greaterOrEquals|รับสองอาร์กิวเมนต์ และส่งกลับค่า true ถ้าอาร์กิวเมนต์แรกมีค่ามากกว่าหรือเท่ากับอาร์กิวเมนต์ที่สอง <br><b>หมายเหตุ</b>: ชนิดที่รองรับคือ จำนวนเต็ม เลขทศนิยม และสตริง|นิพจน์นี้ส่งกลับเป็น false:<br>greaterOrEquals(10,100)
|[empty](#use-the-empty-expression)|ส่งกลับเป็น true ถ้าออบเจ็กต์ อาร์เรย์ หรือสตริงว่างเปล่า|นิพจน์นี้ส่งกลับ true:<br>empty('')
|not|รับสองอาร์กิวเมนต์ และส่งกลับค่า true ถ้าอาร์กิวเมนต์เป็นเท็จ <br><b>หมายเหตุ</b>: ทั้งสองอาร์กิวเมนต์ต้องเป็นบูลีน|นิพจน์นี้ส่งกลับ true:<br>not(contains('200 Success','Fail'))
|if|ส่งกลับค่าระบุถ้านิพจน์เป็นค่า true หรือ false|นิพจน์นี้ส่งกลับ "yes":<br>if(equals(1, 1), 'yes', 'no')

## <a name="prerequisites"></a>ข้อกำหนดเบื้องต้น
* การเข้าถึง Microsoft Flow
* สเปรดชีที่มีตาราง ที่จะอธิบายต่อไปในการฝึกปฏิบัตินี้ ตรวจสอบให้แน่ใจว่า ได้บันทึกสเปรดชีตของคุณในตำแหน่งที่ตั้งเช่น Dropbox หรือ Microsoft OneDrive เพื่อให้ Microsoft Flow สามารถเข้าถึงได้
* Microsoft Office 365 Outlook (ถึงแม้ว่าเราใช้ Office 365 Outlook คุณสามารถใช้บริการอีเมลที่ได้รับการสนับสนุนใด ๆ ในโฟลว์ของคุณได้)

## <a name="use-the-or-expression"></a>ใช้นิพจน์ or
ในบางครั้งเวิร์กโฟลว์ของคุณจำเป็นต้องดำเนินการ ถ้าค่าของรายการคือ ค่าA **หรือ** ค่าB ตัวอย่างเช่น คุณอาจติดตามสถานะของงานในตารางสเปรดชีต สมมติว่า ตารางมีคอลัมน์ที่ชื่อว่า *Status* (สถานะ) และค่าที่เป็นไปได้ในคอลัมน์ *Status* คือ:

* **completed** (เสร็จแล้ว)
* **blocked** (ติดขัด)
* **unnecessary** (ไม่จำเป็น)
* **not started** (ยังไม่ได้เริ่ม)

นี่คือตัวอย่างว่า สเปรดชีตอาจมีลักษณะดังนี้:

![สเปรดชีตตัวอย่าง](./media/use-expressions-in-conditions/spreadsheet-table.png)

จากสเปรดชีตข้างบน คุณต้องการใช้ Microsoft Flow เพื่อนำแถวทั้งหมดที่มีคอลัมน์ *Status* ที่ตั้งค่าเป็น *completed* หรือ *unnecessary* ออกไป

เรามาสร้างโฟลว์กัน

### <a name="start-with-a-blank-flow"></a>เริ่มต้นด้วยโฟลว์ที่ว่างเปล่า
1. ลงชื่อเข้าใช้ [Microsoft Flow](https://flow.microsoft.com)

    ![ลงชื่อเข้าใช้](includes/media/modern-approvals/sign-in.png)
2. เลือกแท็บ**โฟลว์ของฉัน**

    ![เลือกโฟลว์ของฉัน](includes/media/modern-approvals/select-my-flows.png)
3. เลือก**สร้างจากว่างเปล่า**

    ![สร้างจากว่างเปล่า](includes/media/modern-approvals/blank-template.png)

### <a name="add-a-trigger-to-your-flow"></a>เพิ่มทริกเกอร์ให้กับโฟลว์ของคุณ
1. ค้นหา**กำหนดการ** แล้วเลือกทริกเกอร์ **กำหนดการ - การเกิดขึ้นประจำ**

    ![กำหนดการทริกเกอร์](includes/media/schedule-trigger/schedule-trigger.png)
2. ตั้งค่ากำหนดการเพื่อเรียกใช้วันละครั้ง

    ![ตั้งค่ากำหนดการ](includes/media/schedule-trigger/set-schedule.png)

### <a name="select-the-spreadsheet-and-get-all-rows"></a>เลือกสเปรดชีต และรับแถวทั้งหมด
1. เลือก **ขั้นตอนใหม่** > **เพิ่มการดำเนินการ**

    ![ขั้นตอนใหม่](includes/media/new-step/action.png)
2. ค้นหา**แถว** แล้วเลือก**Excel - รับแถว**

    หมายเหตุ: เลือกการดำเนินการ "รับแถว" ที่สอดคล้องกับสเปรดชีตที่คุณกำลังใช้ ตัวอย่างเช่น ถ้าคุณกำลังใช้ Google Sheets เลือก**Google Sheets - รับแถว**

    ![รับแถว](includes/media/new-step/get-excel-rows.png)
3. เลือกไอคอนโฟลเดอร์ในกล่อง**ชื่อไฟล์** เรียกดู แล้วเลือกสเปรดชีตที่มีข้อมูลของคุณ

    ![เลือกสเปรดชีต](includes/media/new-step/select-spreadsheet.png)
4. เลือกตารางที่มีข้อมูลของคุณในรายการ**ชื่อตาราง**

    ![เลือกตาราง](includes/media/new-step/select-table.png)

### <a name="check-the-status-column-of-each-row"></a>ตรวจสอบคอลัมน์สถานะของแต่ละแถว
1. เลือก **ขั้นตอนใหม่** > **เพิ่มเติม** > **เพิ่ม apply to each**

    ![เลือกตาราง](includes/media/new-step/apply-to-each.png)
2. เพิ่มโทเค็น**ค่า**ไปยังกล่อง**เลือกข้อมูลขาออกจากขั้นตอนก่อนหน้า**

    ![เลือกตาราง](includes/media/apply-to-each/add-value-token.png)
3. เลือก **เพิ่มเงื่อนไข** > **แก้ไขในโหมดขั้นสูง**
4. เพิ่มนิพจน์ **or** ต่อไปนี้ นิพจน์ **or** นี้ตรวจสอบค่าของแต่ละแถวในตาราง (แถวถูกเรียกว่า item เมื่อเข้าถึงจากในนิพจน์) ถ้าค่าของคอลัมน์ **Status** คือ *completed* **หรือ** *unnecessary*, นิพจน์ **or** จะประเมินเป็น "true"

    นิพจน์ **or** ที่ใช้เป็นดังต่อไปนี้:

    ````@or(equals(item()?['status'], 'unnecessary'), equals(item()?['status'], 'completed'))````

    การ์ด**เงื่อนไข**ของคุณจะคล้ายกับรูปภาพนี้:

    ![รูปนิพจน์ or](./media/use-expressions-in-conditions/or-expression.png)

### <a name="delete-matching-rows-from-the-spreadsheet"></a>ลบแถวที่ตรงกันออกจากสเปรดชีต
1. เลือก**เพิ่มการดำเนินการ**บนสาขา **ถ้าใช่ ไม่ต้องทำอะไร** ของเงื่อนไข
2. ค้นหา**ลบแถว** แล้วเลือก**Excel - ลบแถว**

    ![รูปลบแถว](includes/media/new-step/select-delete-excel-row.png)
3. ในกล่อง**ชื่อไฟล์** ค้นหาและเลือกไฟล์สเปรดชีตที่มีข้อมูลที่คุณต้องการลบ
4. ในรายการ**ชื่อตาราง** เลือกตารางที่ประกอบด้วยข้อมูลของคุณ
5. ใส่โทเค็น **ID แถว**ในกล่อง **ID แถว**

    ![แฟ้มสเปรดชีต](includes/media/new-step/delete-excel-row.png)

### <a name="name-the-flow-and-save-it"></a>ตั้งชื่อโฟลว์และบันทึก
1. ตั้งชื่อให้โฟลว์ของคุณ จากนั้นเลือกปุ่ม**สร้างโฟลว์**

    ![บันทึกโฟลว์ของคุณ](./media/use-expressions-in-conditions/name-and-save.png)

### <a name="run-the-flow-with-the-or-expression"></a>เรียกใช้โฟลว์ที่มีนิพจน์ or
โฟลว์ทำงานหลังจากที่คุณบันทึก ถ้าคุณสร้างสเปรดชีตที่แสดงไว้ก่อนหน้านี้ในการฝึกปฏิบัติ นี่คือหน้าตาของสเปรดชีตหลังจากการทำงานเสร็จสมบูรณ์:

![นิพจน์ or เสร็จสมบูรณ์](./media/use-expressions-in-conditions/spreadsheet-table-after-or-expression-runs.png)

สังเกตว่า ข้อมูลทั้งหมดในแถวที่มี "completed" หรือ "unnecessary" ในคอลัมน์ Status ถูกลบออก

## <a name="use-the-and-expression"></a>ใช้นิพจน์ and
สมมติว่า คุณมีตารางสเปรดชีตที่มีสองคอลัมน์ ชื่อคอลัมน์คือ Status และ Assigned และสมมติว่าคุณต้องการลบแถวทั้งหมดถ้าค่าของคอลัมน์ Status เป็น "blocked" และค่าของคอลัมน์ Assigned เป็น "John Wonder"  เพื่อให้สำเร็จงานนี้ ทำตามขั้นตอนทั้งหมดก่อนหน้านี้ในการฝึกปฏิบัตินี้ แต่เมื่อคุณแก้ไขการ์ด**เงื่อนไข**ในโหมดขั้นสูง ใช้นิพจน์ **and** ที่แสดงไว้ที่นี่:

````@and(equals(item()?['Status'], 'blocked'), equals(item()?['Assigned'], 'John Wonder'))````

การ์ด**เงื่อนไข**ของคุณจะคล้ายกับรูปภาพนี้:

![รูปนิพจน์ and](./media/use-expressions-in-conditions/and-expression.png)

### <a name="run-the-flow-with-the-and-expression"></a>เรียกใช้โฟลว์ที่มีนิพจน์ and
ถ้าคุณทำตาม สเปรดชีตของคุณจะคล้ายกับรูปภาพนี้:

![ก่อนเรียกใช้ and](./media/use-expressions-in-conditions/spreadsheet-table-before-and-expression-runs.png)

หลังจากที่โฟลว์ของคุณทำงาน สเปรดชีตของคุณจะคล้ายกับรูปภาพนี้:

![หลังเรียกใช้ and](./media/use-expressions-in-conditions/spreadsheet-table-after-and-expression-runs.png)

## <a name="use-the-empty-expression"></a>ใช้นิพจน์ empty
สังเกตว่า ขณะนี้มีหลายแถวที่ว่างเปล่าในสเปรดชีต เพื่อเอาแถวที่ว่างออก ใช้นิพจน์ **empty** เพื่อระบุแถวทั้งหมดที่ไม่มีข้อความใด ๆ ในคอลัมน์ Assigned และ Status

เพื่อทำงานนี้ให้สำเร็จ ทำตามขั้นตอนทั้งหมดที่แสดงอยู่ในส่วน**ใช้นิพจน์ and** ก่อนหน้านี้ในการฝึกปฏิบัติ แต่เมื่อคุณแก้ไขการ์ด**เงื่อนไข**ในโหมดขั้นสูง ใช้นิพจน์ empty ดังนี้:

````@and(empty(item()?['Status']), empty(item()?['Assigned']))````

การ์ด**เงื่อนไข**ของคุณจะคล้ายกับรูปภาพนี้:

![รูปนิพจน์ empty](./media/use-expressions-in-conditions/empty-expression.png)

หลังจากที่โฟลว์ของคุณทำงาน สเปรดชีตจะคล้ายกับรูปภาพนี้:

![หลังจากเรียกใช้ empty](./media/use-expressions-in-conditions/spreadsheet-table-after-empty-expression-runs.png)

สังเกตว่าบรรทัดที่เกินจะถูกเอาออกจากตาราง

## <a name="use-the-greater-expression"></a>ใช้นิพจน์ greater
สมมติว่า คุณได้ซื้อตั๋วเบสบอลสำหรับเพื่อนร่วมงานของคุณ และคุณกำลังใช้สเปรดชีตเพื่อให้แน่ใจว่า คุณได้รับชำระเงินคืนจากทุกคน คุณสามารถสร้างโฟลว์อย่างรวดเร็ว เพื่อส่งอีเมลรายวันไปที่คนที่ยังไม่ได้ชำระเงินเต็มจำนวน

ใช้นิพจน์ **greater** เพื่อหาพนักงานที่ยังไม่ได้ชำระเงินเต็มจำนวน จากนั้นคุณสามารถส่งอีเมลเตือนที่เป็นมิตร สำหรับผู้ที่ยังไม่ได้ชำระเงินครบ โดยอัตโนมัติ

นี่คือมุมมองของสเปรดชีต:

![มุมมองของสเปรดชีต](./media/use-expressions-in-conditions/tickets-spreadsheet-table.png)

นี่คือการใช้งานของนิพจน์ **greater** ที่หาคนทั้งหมดที่ชำระเงินน้อยกว่ายอดเงินที่ต้องชำระ:

````@greater(item()?['Due'], item()?['Paid'])````

## <a name="use-the-less-expression"></a>ใช้นิพจน์ less
สมมติว่า คุณได้ซื้อตั๋วเบสบอลสำหรับเพื่อนร่วมงานของคุณ และคุณกำลังใช้สเปรดชีตเพื่อให้แน่ใจว่า คุณได้รับชำระเงินคืนจากทุกคน ภายในวันที่ทุกคนตกลงกัน คุณสามารถสร้างโฟลว์ที่ส่งอีเมลให้คนที่ไม่ได้ชำระยอดเงินเต็มจำนวน ถ้าวันที่ปัจจุบันคือหนึ่งวันก่อนถึงวันครบกำหนด

ใช้นิพจน์ **and** พร้อมกับนิพจน์ **less** เนื่องจากมีเงื่อนไขสองเงื่อนไขที่ต้องตรวจสอบ:


|          เงื่อนไขของการตรวจสอบ          | นิพจน์ที่ใช้ |                    ตัวอย่าง                     |
|-----------------------------------------|-------------------|------------------------------------------------|
|   ได้ชำระยอดเงินเต็มจำนวนแล้วหรือไม่?    |      greater      |   @greater(item()?['Due'], item()?['Paid'])    |
| อีกหนึ่งวันจะถึงวันครบกำหนดหรือไม่? |       less        | @less(item()?['DueDate'], addDays(utcNow(),1)) |

## <a name="combine-the-greater-and-less-expressions-in-an-and-expression"></a>รวมนิพจน์ greater และ less ด้วยนิพจน์ and
ใช้นิพจน์ **greater** เพื่อหาพนักงานที่ชำระเงินน้อยกว่าจำนวนเงินที่ต้องชำระ และใช้นิพจน์ **less** เพื่อหาว่าวันครบครบกำหนดอยู่ถัดจากวันที่ปัจจุบันไม่ถึงหนึ่งวันหรือไม่ จากนั้นคุณสามารถดำเนินการ**ส่งอีเมล**เพื่อเตือนอย่างเป็นมิตร ให้กับผู้ที่ยังไม่ได้ชำระเงินเต็มจำนวน และอีกไม่ถึงหนึ่งวันจะเป็นวันครบกำหนดได้

นี่คือมุมมองของตารางสเปรดชีต:

![มุมมองของสเปรดชีต](./media/use-expressions-in-conditions/spreadsheet-table-due-date.png)

นี่คือการใช้งานของนิพจน์ **and** ที่ค้นหาคนทั้งหมดที่ยังชำระเงินไม่ครบ และอีกไม่ถึงหนึ่งวันก็จะครบกำหนด:

````@and(greater(item()?['Due'], item()?['Paid']), less(item()?['dueDate'], addDays(utcNow(),1)))````

## <a name="learn-more"></a>เรียนรู้เพิ่มเติม
เรียนรู้เกี่ยวกับ[นิพจน์](https://docs.microsoft.com/azure/logic-apps/logic-apps-workflow-definition-language#functions)อื่น ๆ

